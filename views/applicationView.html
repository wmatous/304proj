

<script>
    submitForm = function () {
        // not sure about applicationID, account ID

        const postingid = document.getElementById('postingID').value;
        const coverletter = document.getElementById('coverletter').value;
        const resume = document.getElementById('resume').value;
        // const accountId = url.searchParams.get("accountId");
        const accountId = getCookie('accountId');
        const applicationId = postingid + accountId; // just a way to generate application ID

        urlPath = 'http://localhost:6789/application/';
        urlPath += ('?accountId=' + accountId + '&PostingID=' + postingid + '&applicationId=' + applicationId +
            '&coverletter=' + coverletter + '&resume=' + resume); // pretty dumb way to pass texts like that
        // post coverletter
        // post resume
        fetch(urlPath,
            {method: 'POST'})
            .then((res) => res.json())
            .then(data => console.log(data))
            .catch(err => console.error(err));
    };

    listApplications = function (accountId) {
        let appl = document.getElementById("applications");
        appl.style.visibility = "visible";
        urlPath = 'http://localhost:6789/application/';
        urlPath += ('?accountId=' + accountId);
        fetch(urlPath)
            .then((res) => res.json())
            .then(data => append(data))
            .catch(err => console.error(err));
    };

     append=function(data) {
        var accumulator = document.getElementById("applications");
        for (var i = 0; i < data.length; i++) {
            var td = document.createElement("tr");
            td.append("<th>" + data[i].APPLICATIONID + "<th>");
            td.append("<th>" + data[i].COVERLETTER + "<th>");
            td.append("<th>" + data[i].RESUME + "<th>");
            td.append("<th>" + data[i].APPLICANTID + "<th>");
            td.append("<th>" + data[i].POSTINGID + "<th>");
            accumulator.append(td);
        }
    }

    window.onload = function () {
    var loggedInAccount = getCookie('accountId');
    listApplications(loggedInAccount);
};

getCookie = function(name) {
    var value = "; " + document.cookie;
    var parts = value.split("; " + name + "=");
    if (parts.length == 2) return parts.pop().split(";").shift();
};

</script>
<style>

    input {
        border: 0;
        outline: 0;
        background: rgb(187, 187, 187);
    }

    .applicationBox {
        background: rgb(206, 206, 206);
    }
</style>


<div>
    <table class='applicationBox'>
        <tr>
            <td>
                PostingID:
            </td>
            <td>
                <input type='number'
                       id='PostingID'
                       data-fieldid='PostingID'/>
            </td>
        </tr>
        <tr>
            <td>
                CoverLetter:
            </td>
            <td>
                    <textarea name='coverletter'
                              id='coverletter'
                              cols='20' rows='10'></textarea>
            </td>
        </tr>
        <tr>
            <td>
                Resume:
            </td>
            <td>
                    <textarea name='resume'
                              id='resume'
                              cols='20' rows='10'></textarea>
            </td>
        </tr>
    </table>
    <button onclick='submitForm()'> Save</button>
    <button onclick='listApplications()'> See your applications</button>
</div>
<div id="applics">
    <table id='applications' style="visibility:hidden">
        <tr>
            <th>ApplicationID</th>
            <th>CoverLetter</th>
            <th>Resume</th>
            <th>ApplicantID</th>
            <th>PostingID</th>
        </tr>
    </table>
</div>
